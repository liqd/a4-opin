{% load static i18n flashpoll_form_tags widget_tweaks %}

<link rel="stylesheet" href="{% static 'highcharts.css' %}">
<script src="{% static 'highcharts.js' %}"></script>
<script src="{% static 'js/flashpoll.js' %}"></script>
<script src="{% static 'js/flashpoll_result.js' %}"></script>

<article id="result"
         class="flashpoll"
         data-api-key="{% api_key %}"
         data-poll="{{ poll|get_simplejson }}"
         data-poll-result="{{ pollresult|get_simplejson }}">

    <h1 class="dashboard-content-heading">{% trans 'Answers and Export'%}</h1>
    <div class="">

        {% if pollresult.noOfReceivedResults != 0 %}
            {% for question in poll.questions %}
                {% if question.questionType != 'ORDER' %}
                    Question type: <b>{{ question.questionType }}</b>
                {% else  %}
                    Question type: <b>RANKING</b>
                {% endif %}
                {% if question.questionType != 'FREETEXT' %}
                <div class="form-group">
                    <div id="container-{{question.orderId}}" class="question-result"></div>
                </div>
                {% else  %}
                <div class="form-group">
                    <label >{{ question.questionText }}</label>
                    <p class='form-help-text'>Visualization not implemented for this type of question</p>
                </div>
                {% endif %}
            {% endfor %}
        {% endif %}

        {% if poll %}
            <button
                class="btn btn-primary"
                onclick="exportResults({{pollresults|get_simplejson}}, {{poll.title|get_simplejson}})">
                <i class="fa fa-download" ></i> {% trans 'Download Answers' %}
            </button>
        {% endif %}
    </div>

</article>
