{% extends 'euth_projects/project_detail.html' %}
{% load i18n rules idea_tags %}

{% block phase_content %}
<div class="idea-list">
    {% has_perm 'euth_ideas.propose_idea' request.user view.module as add_button_enabled %}
    {% if add_button_enabled %}
    <a href="{% url 'idea-create' slug=view.module.slug %}" class="idea-list-button" id="idea-create">
        <i class="fa fa-plus idea-list-button-icon" aria-hidden="true"></i>
        {% trans 'Create Proposal' %}
    </a>
    {% endif %}

    {% if view.sorts and idea_list.count > 1 %}
        <div class="dropdown sort-dropdown pull-right">
            {% trans 'Sort by' %}
            <a id="drop" class="dropdown-toggle" type="button" data-toggle="dropdown"
                role="button" aria-haspopup="true" aria-expanded="false">
                {{ view.get_current_sortname }}
                <i class="fa fa-caret-down" aria-hidden="true"></i>
            </a>
            <ul class="dropdown-menu" aria-labelledby="drop">
                {% for sort, sort_name in view.sorts %}
                    <li>
                        {% if view.sort == sort %}
                            <a><strong>{{ sort_name }}</strong></a>
                        {% else %}
                            <a href="?sort={{sort}}#idea-create">{{ sort_name }}</a>
                        {% endif %}
                    </li>
                {% endfor %}
            </ul>
        </div>
    {% endif %}

    {% for idea in idea_list %}
    {% include "euth_ideas/includes/idea_list_tile.html" with idea=idea %}
    {% endfor %}

    {% if is_paginated %}
    <nav aria-label="Page navigation">
        <div class="text-center">
            <ul class="pagination">

                {% if page_obj.has_previous and page_obj.paginator.num_pages >= 6  %}
                <li>
                    <a href="?{% if view.sort %}sort={{view.sort}}&{% endif %}page={{ page_obj.previous_page_number }}#idea-create" aria-label="Previous">
                        <span aria-hidden="true"><i class="fa fa-chevron-left" aria-hidden="true"></i></span>
                    </a>
                </li>
                {% endif %}

                {% if page_obj.paginator.num_pages < 6 %}
                {% for page in page_obj.paginator.page_range %}
                <li {% ifequal page page_obj.number %}class="active"{% endifequal %}>
                    <a href="?{% if view.sort %}sort={{view.sort}}&{% endif %}page={{ page }}#idea-create" aria-label="Next">
                        {{ page }}
                    </a>
                </li>
                {% endfor %}
                {% else %}
                {% get_range page_obj.number page_obj.paginator.num_pages as range %}
                {% for page in range %}
                <li {% ifequal page page_obj.number %}class="active"{% endifequal %}>
                    <a href="?{% if view.sort %}sort={{view.sort}}&{% endif %}page={{ page }}#idea-create">
                        {{ page }}
                    </a>
                </li>
                {% endfor %}
                {% endif %}

                {% if page_obj.has_next and page_obj.paginator.num_pages >= 6 %}
                <li>
                    <a href="?{% if view.sort %}sort={{view.sort}}&{% endif %}page={{ page_obj.next_page_number }}#idea-create" aria-label="Next">
                        <span aria-hidden="true"><i class="fa fa-chevron-right" aria-hidden="true"></i></span>
                    </a>
                </li>
                {% endif %}

            </ul>
            {% if page_obj.paginator.num_pages >= 6 %}
            <p>Page {{ page_obj.number }} of {{ page_obj.paginator.num_pages }}</p>
            {% endif %}
        </div>
    </nav>
    {% endif %}

</div>
{% endblock %}
