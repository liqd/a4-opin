{% extends "base.html" %}
{% load i18n static %}

{% block title %}{{view.project.name}}{% endblock %}
{% block extra_js %}
    <script>
        $(function () {
            $('[data-toggle="popover"]').popover()
        })
    </script>
{% endblock %}
{% block content %}
{% include 'euth_projects/includes/project_hero_unit.html' with project=view.project %}
{% with view.project.phases as phases %}
    <div class="timeline">
        <p class="text-uppercase">Timeline</p>
        <ul>
            {% for phase in phases %}
                <li class="{% if phase == view.project.active_phase %}active{% endif %}">
                    <div class="dot" title="{% trans "Phase" %} {{ forloop.counter }}/{{ phases|length }}
                         {% if phase == view.project.active_phase %}
                             <div class='label label-secondary pull-right'>{% trans 'Active phase' %}</div>
                         {% endif %}"
                         data-toggle="popover" data-html="true" data-trigger="hover" data-placement="auto top"
                         id="button-phase-{{ forloop.counter }}"
                         data-content="
                                <p class='small'>{{ phase.start_date|date:"SHORT_DATE_FORMAT" }} - {{ phase.end_date|date:"SHORT_DATE_FORMAT" }}</p>
                                <h4>{{ phase.name }}</h4>
                            "></div>
                    {% if not forloop.last and phases|length > 1 %}
                        <span class="fa fa-caret-right"></span>
                        <span class="fa fa-caret-right hidden-xs"></span>
                        <span class="fa fa-caret-right hidden-xs"></span>
                    {% endif %}
                </li>
            {% endfor %}
        </ul>
    </div>
{% endwith %}
<nav class="tabs">
    <div class="container">
        <ul>
            <li class="col-md-4 {% if not view.project.active_phase %} active {% endif %}"><a href="#information" data-toggle="tab" class="tab">{% trans "Information" %}</a></li>
            <li class="col-md-4 {% if view.project.active_phase %} active {% endif %}"><a href="#participation" data-toggle="tab" class="tab">{% trans "Participation" %}</a></li>
            <li class="col-md-4"><a href="#result" data-toggle="tab" class="tab">{% trans "Result" %}</a></li>
        </ul>
    </div>
</nav>
<div class="container">
    <article id="information" class="tab-panel {% if not view.project.active_phase %} active {% endif %}">
        <h3 class="tab-panel-title">{% trans "info" %}</h3>
        <div class="tab-panel-description">
            {{ view.project.information |safe|linebreaks }}
        </div>
    </article>
    <article id="participation" class="tab-panel {% if view.project.active_phase %} active {% endif %}">
        <div class="tab-panel-description">

            {% if view.is_between_phases %}
            {% include 'euth_contrib/includes/info_note.html' with image='images/project_info_note.png' title='Thanks for participating!' text='This phase is already over. Thanks a lot to everyone for taking part in the process! The next phase will start soon.' %}
            {% endif %}

            {% if not view.phase and not view.is_between_phases %}
            {% include 'euth_contrib/includes/info_note.html' with image='images/project_info_note.png' title='Welcome!' text='This project has not started yet!' %}
            {% endif %}

            <h2>{{ view.phase.name }}</h2>
            <p class="idea-list-description">{{ view.phase.description }} </p>

            {% if view.phase and not view.is_between_phases %}
            <div class="badge-group">
                <span class="badge">
                    <strong>{% trans 'Start Date' %}</strong>
                    {{ view.phase.start_date.date }}
                </span>
                <span class="badge">
                    <strong>{% trans 'End Date' %}</strong>
                    {{ view.phase.end_date.date }}
                </span>
            </div>
            {% endif %}

            {% block phase_content %}{% endblock %}
        </div>
    </article>
    <article id="result" class="tab-panel">
        <div class="tab-panel-description">
            {% trans 'There are no results yet. Please check back later.' as no_results %}
            {{ view.project.result |default:no_results|safe|linebreaks }}
        </div>
    </article>
</div>
{% if view.project.other_projects %}
<div class="project-other-projects">
    <div class="black-divider">
        <div class="container">
            <div class="container-narrow">
                <div class="black-divider-text">
                    <span>
                        {% trans 'other projects from this organisation'%}
                    </span>
                </div>
            </div>
        </div>
    </div>
    <div class="container">
        {% include "euth_projects/includes/project_carousel.html" with projects=view.project.other_projects %}
    </div>
</div>
{% endif %}


{% endblock %}
